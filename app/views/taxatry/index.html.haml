- @title = 'Taxatry'

- content_for :head do
  = javascript_include_tag 'taxatry'
  = stylesheet_link_tag 'taxatry'

- content_for :header do
  .left
    %h1 Taxatry

      
.taxonomic_history
  = @taxonomic_history

%table.browser
  %tr
    %td
      %table.subfamily
        %tr
          %td.rank_header Subfamilies
        %tr
          %td
            .rank_column
              %table
                - @subfamilies.each do |subfamily|
                  %tr
                    %td= taxon_link subfamily, @selected_subfamily

    %td
      %table.genera
        %tr
          %td.rank_header Genera
        %tr
          %td
            .rank_column
              - if @genera
                %table
                  - column_count = @genera.count / 30.0
                  - css_class = ''
                  - if column_count < 1
                    - column_count = 1
                  - else
                    - column_count = column_count.ceil
                  - if column_count > 5
                    - column_count = 5
                    - css_class = 'teensy'
                  - rows = @genera.snake column_count
                  - rows.each do |row|
                    %tr
                      - row.each do |genus|
                        %td{:class => css_class}
                          - if genus
                            = taxon_link genus, @selected_genus

    %td
      %table.species
        %tr
          %td.rank_header Species
        %tr
          %td
            .rank_column
              - if @species
                %table
                  - column_count = @species.count / 30.0
                  - css_class = ''
                  - if column_count < 1
                    - column_count = 1
                  - else
                    - column_count = column_count.ceil
                  - if column_count > 4
                    - column_count = 4
                    - css_class = 'teensy'
                  - rows = @species.snake column_count
                  - rows.each do |row|
                    %tr
                      - row.each do |species|
                        %td{:class => css_class}
                          - if species
                            = taxon_link species, @selected_species

%div.clear
