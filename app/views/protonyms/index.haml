-@title = "Protonyms"
-breadcrumb :protonyms

=content_for :breadcrumbs_right do
  =link_to "Hide/show search", "#", data: { show_hide_toggler_for: "search-form" }, class: "btn-nodanger"
  -if params[:order] == ProtonymsController::TAXON_COUNT_ORDER
    =link_to "Order by name", protonyms_path(request.params.merge(order: nil)), class: "btn-normal"
  -else
    =link_to "Order by taxon count", protonyms_path(request.params.merge(order: ProtonymsController::TAXON_COUNT_ORDER)), class: "btn-normal"

  -if params[ProtonymsController::ONLY_WITH_TYPE_TAXON]
    =link_to "Don't hide without type taxon", protonyms_path(request.params.merge(ProtonymsController::ONLY_WITH_TYPE_TAXON => nil)), class: "btn-normal"
  -else params[ProtonymsController::ONLY_WITH_TYPE_TAXON]
    =link_to "Hide without type taxon", protonyms_path(request.params.merge(ProtonymsController::ONLY_WITH_TYPE_TAXON => 'yes')), class: "btn-normal"

  -if user_is_editor?
    =link_to "New", new_protonym_path, class: "btn-normal"

.margin-bottom{class: ('show-hide-toggable-starts-open' if params[:q].present?), data: { show_hide_toggable_id: "search-form" } }
  .row
    .medium-12.columns
      =form_tag protonyms_path, method: :get do
        =text_field_tag :q, params[:q], placeholder: "Search Protonyms", class: 'input-group-field'
        =button_tag type: 'submit', class: 'btn-normal' do
          ="Search ".html_safe + search_icon

%table
  %thead
    %tr
      %th Name
      %th Authorship
      %th Pages
      %th Forms
      %th Locality
      %th Notes
      %th Taxa
  %tbody
    -@protonyms.each do |protonym|
      %tr
        %td
          =protonym.decorate.link_to_protonym
          -if protonym.sic?
            [sic]
        %td=protonym.authorship.reference.decorate.expandable_reference
        %td=protonym.authorship.pages
        %td=or_dash protonym.authorship.forms
        %td=protonym.decorate.format_locality
        %td=or_dash Detax[protonym.authorship.notes_taxt]
        %td=protonym.taxa_count

=will_paginate @protonyms
