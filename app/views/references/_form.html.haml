- reference ||= Reference.new
- publisher_name = reference.respond_to?(:publisher) ? (reference.publisher && reference.publisher.name) : ''
.reference_form
  - url = reference.new_record? ? references_path : reference_path(reference)
  - method = reference.new_record? ? 'post' : 'put'
  - form_for :reference, reference, :url => url do |f|
    %input{:type => 'hidden', :name => '_method', :value => method}
    = render :partial => 'shared/errors_for', :locals => { :resource => reference }

    %div
      = f.text_field :authors_string
      = f.text_field :citation_year
    %div
      = f.text_field :title
    %div.tabs
      %ul
        %li
          %a{:href => "#tabs-1-#{reference.id}"}Article
        %li
          %a{:href => "#tabs-2-#{reference.id}"}Book
        %li
          %a{:href => "#tabs-3-#{reference.id}"}Other
      %div{:id => "tabs-1-#{reference.id}"}
        %p
          = text_field_tag :journal_title
      %div{:id => "tabs-2-#{reference.id}"}
        %p
          = text_field_tag :publisher_place
          = text_field_tag :publisher_name, publisher_name
      %div{:id => "tabs-3-#{reference.id}"}
        %p
          = text_field_tag :publisher_place
          = text_field_tag :publisher_name
          = text_field_tag :pagination
    %div
      = f.text_field :public_notes
    %div
      = f.text_field :editor_notes
    %div
      = f.text_field :taxonomic_notes
    %div
      = f.text_field :cite_code
      = f.text_field :possess
      = f.text_field :date
    %div
      = f.submit 'OK', :name => 'commit'
      %button.cancel Cancel
      %button.delete Delete
